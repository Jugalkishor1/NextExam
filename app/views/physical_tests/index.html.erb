<div class="min-h-screen bg-gradient-to-b from-blue-200 to-blue-100 dark:from-blue-900 dark:to-blue-800 flex justify-center items-center py-10 px-5">
  <div class="max-w-4xl w-full bg-white dark:bg-gray-800 rounded-3xl shadow-xl p-8 sm:p-12">

    <div class="text-center mb-8">
      <h1 class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-indigo-300 dark:to-purple-400">
        ğŸš” MP Police Physical Test Calculator
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-300">Choose a mode and enter your performance data</p>
    </div>

    <div class="flex justify-center mb-8 space-x-4 gap-2">
      <button id="mode-performance" class="w-1/2 py-2 sm:py-3 px-4 rounded-lg sm:px-5 text-base sm:text-lg font-semibold bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 shadow-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-all">
        Performance â†’ Marks
      </button>
      <button id="mode-marks" class="w-1/2 py-2 sm:py-3 px-4 rounded-lg sm:px-5 text-base sm:text-lg font-semibold bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 shadow-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-all">
        Marks â†’ Performance
      </button>
    </div>

    <form id="performance-form" class="space-y-6">
      <h2 class="text-2xl mb-6 font-semibold text-center text-indigo-600 dark:text-indigo-300">Enter Your Performance</h2>

      <div class="grid sm:grid-cols-3 gap-6">
        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸƒâ€â™‚ï¸ 800m Run (seconds)</label>
          <input type="number" id="run_time" step="0.1" placeholder="e.g. 150"
            class="input-field">
        </div>

        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸ… Long Jump (feet)</label>
          <input type="number" id="long_jump" step="0.01" placeholder="e.g. 17.5"
            class="input-field">
        </div>

        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸ’ª Shot Put (feet)</label>
          <input type="number" id="shot_put" step="0.01" placeholder="e.g. 30"
            class="input-field">
        </div>
      </div>

      <button type="submit" class="w-full py-3 rounded-lg text-white mt-6 font-semibold bg-gradient-to-r from-indigo-500 to-purple-600 shadow-lg hover:opacity-90 transition-all">
        Calculate Marks
      </button>
    </form>

    <form id="marks-form" class="space-y-6 hidden">
      <h2 class="text-2xl mb-6 font-semibold text-center text-purple-600 dark:text-purple-400">Enter Desired Marks</h2>
      <div class="grid sm:grid-cols-3 gap-6">
        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸƒâ€â™‚ï¸ 800m Run Marks (0â€“30)</label>
          <input type="number" id="run_marks" min="0" max="30" placeholder="e.g. 25"
            class="input-field">
        </div>

        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸ… Long Jump Marks (0â€“30)</label>
          <input type="number" id="long_marks" min="0" max="30" placeholder="e.g. 20"
            class="input-field">
        </div>

        <div class="input-group">
          <label class="block text-sm mb-1 font-medium text-gray-700 dark:text-gray-300">ğŸ’ª Shot Put Marks (0â€“30)</label>
          <input type="number" id="shot_marks" min="0" max="30" placeholder="e.g. 27"
            class="input-field">
        </div>
      </div>

      <button type="submit" class="w-full py-3 mt-6 rounded-lg text-white font-semibold bg-gradient-to-r from-purple-500 to-pink-500 shadow-lg hover:opacity-90 transition-all">
        Get Required Performance
      </button>
    </form>

    <!-- Results Section -->
    <div id="result" class="mt-10 hidden">
      <h3 class="text-2xl mb-3 font-semibold text-center text-indigo-600 dark:text-indigo-300">ğŸ“Š Results Summary</h3>
      <div id="result-content" class="grid sm:grid-cols-3 gap-6">
        <!-- Result content will be inserted here -->
      </div>
    </div>
    
    <!-- Prev Results Section -->
    <div id="prev-result" class="mt-10">
      <h3 class="text-2xl mb-3 font-semibold text-center text-indigo-600 dark:text-indigo-300">ğŸ“Š Prev Results Summary</h3>
        <div id="prev-result-content" class="grid sm:grid-cols-3 gap-6">
          <div class="bg-indigo-100 dark:bg-indigo-900 p-5 rounded-lg shadow-md">
          <h4 class="font-semibold text-indigo-600 dark:text-indigo-300">ğŸƒ 800m Run</h4>
          <p class="dark:text-indigo-300">Marks: <strong>18</strong></p>
          <p class="dark:text-indigo-300">Time: <strong>164 sec</strong></p>
        </div>
        <div class="bg-purple-100 dark:bg-purple-900 p-5 rounded-lg shadow-md">
          <h4 class="font-semibold text-purple-600 dark:text-purple-300">ğŸ… Long Jump</h4>
          <p class="dark:text-indigo-300">Marks: <strong>17</strong></p>
          <p class="dark:text-indigo-300">Jump: <strong>14.5 ft (4.42 m)</strong></p>
        </div>
        <div class="bg-green-100 dark:bg-green-900 p-5 rounded-lg shadow-md">
          <h4 class="font-semibold text-green-600 dark:text-green-300">ğŸ’ª Shot Put</h4>
          <p class="dark:text-indigo-300">Marks: <strong>21</strong></p>
          <p class="dark:text-indigo-300">Throw: <strong>24 ft (7.32 m)</strong></p>
        </div>
        <div class="col-span-3 mt-4">
          <hr class="my-4 border-gray-300 dark:border-gray-700">
          <p class="text-lg font-semibold text-indigo-600 dark:text-indigo-300">ğŸ¯ Total: <strong>56</strong>/100</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const performanceForm = document.getElementById("performance-form");
  const marksForm = document.getElementById("marks-form");
  const resultBox = document.getElementById("result");
  const PrevResultBox = document.getElementById("prev-result");
  const resultContent = document.getElementById("result-content");
  const PrevResultContent = document.getElementById("prev-result-content");
  const modePerformance = document.getElementById("mode-performance");
  const modeMarks = document.getElementById("mode-marks");

  const switchMode = (activeBtn, inactiveBtn, showForm, hideForm) => {
    showForm.classList.remove("hidden");
    hideForm.classList.add("hidden");
    activeBtn.classList.add("bg-gradient-to-r", "from-indigo-500", "to-purple-600", "text-white");
    inactiveBtn.classList.remove("bg-gradient-to-r", "from-indigo-500", "to-purple-600", "text-white");
    resultBox.classList.add("hidden");
  };

  modePerformance.addEventListener("click", () => switchMode(modePerformance, modeMarks, performanceForm, marksForm));
  modeMarks.addEventListener("click", () => switchMode(modeMarks, modePerformance, marksForm, performanceForm));

  const validateInput = (value) => value !== "" && !isNaN(value) && value >= 0;

  performanceForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const run_time = parseFloat(document.getElementById("run_time").value);
    const long_jump = parseFloat(document.getElementById("long_jump").value);
    const shot_put = parseFloat(document.getElementById("shot_put").value);

    if (![run_time, long_jump, shot_put].every(validateInput)) {
      alert("âš ï¸ Please enter valid performance values.");
      return;
    }

    const response = await fetch("/physical_tests/calculate", {
      method: "POST",
      headers: { "Content-Type": "application/json", "X-CSRF-Token": document.querySelector('meta[name="csrf-token"]').content },
      body: JSON.stringify({ mode: "performance", run_time, long_jump, shot_put })
    });

    const data = await response.json();
    resultContent.innerHTML = `
      <div class="bg-indigo-100 dark:bg-indigo-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-indigo-600 dark:text-indigo-300">ğŸƒ 800m Run</h4>
        <p class="dark:text-indigo-300">Marks: <strong>${data.running_marks}</strong></p>
        <p class="dark:text-indigo-300">Time: <strong>${run_time} sec</strong></p>
      </div>
      <div class="bg-purple-100 dark:bg-purple-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-purple-600 dark:text-purple-300">ğŸ… Long Jump</h4>
        <p class="dark:text-indigo-300">Marks: <strong>${data.long_jump_marks}</strong></p>
        <p class="dark:text-indigo-300">Jump: <strong>${long_jump} ft (${(long_jump * 0.3048).toFixed(2)} m)</strong></p>
      </div>
      <div class="bg-green-100 dark:bg-green-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-green-600 dark:text-green-300">ğŸ’ª Shot Put</h4>
        <p class="dark:text-indigo-300">Marks: <strong>${data.shot_put_marks}</strong></p>
        <p class="dark:text-indigo-300">Throw: <strong>${shot_put} ft (${(shot_put * 0.3048).toFixed(2)} m)</strong></p>
      </div>
      <div class="col-span-3 mt-4">
        <p class="text-lg font-semibold text-indigo-600 dark:text-indigo-300">ğŸ¯ Total: <strong>${data.total}</strong>/100</p>
        <hr class="border-gray-300 dark:border-gray-700">
      </div>
    `;
    resultBox.classList.remove("hidden");
  });

  marksForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const run_marks = parseInt(document.getElementById("run_marks").value);
    const long_marks = parseInt(document.getElementById("long_marks").value);
    const shot_marks = parseInt(document.getElementById("shot_marks").value);

    if (![run_marks, long_marks, shot_marks].every(v => v >= 0 && v <= 30)) {
      alert("âš ï¸ Marks should be between 0â€“30.");
      return;
    }

    const response = await fetch("/physical_tests/calculate", {
      method: "POST",
      headers: { "Content-Type": "application/json", "X-CSRF-Token": document.querySelector('meta[name="csrf-token"]').content },
      body: JSON.stringify({ mode: "marks", run_marks, long_marks, shot_marks })
    });

    const data = await response.json();
    debugger
    resultContent.innerHTML = `
      <div class="bg-indigo-100 dark:bg-indigo-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-indigo-600 dark:text-white">ğŸƒ Required Time</h4>
        <p class="font-semibold text-indigo-600 dark:text-white"><strong>${data.required_run.toFixed(2)} sec</strong></p>
      </div>
      <div class="bg-purple-100 dark:bg-purple-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-purple-600 dark:text-purple-300">ğŸ… Required Jump</h4>
        <p class="font-semibold text-indigo-600 dark:text-white"><strong>${data.required_long_jump.toFixed(2)} ft</strong> (${(data.required_long_jump * 0.3048).toFixed(2)} m)</p>
      </div>
      <div class="bg-green-100 dark:bg-green-900 p-5 rounded-lg shadow-md">
        <h4 class="font-semibold text-green-600 dark:text-green-300">ğŸ’ª Required Throw</h4>
        <p class="font-semibold text-indigo-600 dark:text-white"><strong>${data.required_shot_put.toFixed(2)} ft</strong> (${(data.required_shot_put * 0.3048).toFixed(2)} m)</p>
      </div>
      <div>
        <p class="text-lg font-semibold text-indigo-600 dark:text-indigo-300">ğŸ¯ Total: <strong>${data.total_marks}</strong>/100</p>
        <hr class="my-4 border-gray-300 dark:border-gray-700">
      </div>
    `;
    resultBox.classList.remove("hidden");
  });
});
</script>
